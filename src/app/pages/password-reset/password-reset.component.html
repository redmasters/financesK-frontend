<div class="password-reset-container">
  <div class="password-reset-card">
    <!-- Loading state while checking token -->
    <div *ngIf="isCheckingToken" class="loading-state">
      <div class="loading-spinner">
        <i class="fas fa-spinner fa-spin"></i>
      </div>
      <h2>Verificando token...</h2>
      <p>Por favor, aguarde enquanto validamos seu link de redefinição de senha.</p>
    </div>

    <!-- Invalid token state -->
    <div *ngIf="!isCheckingToken && !isValidToken" class="invalid-token-state">
      <div class="error-icon">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <h2>Token Inválido</h2>
      <p class="error-message">{{ error }}</p>
      <p class="error-description">
        O link de redefinição de senha pode ter expirado ou ser inválido.
        Solicite um novo link de redefinição de senha.
      </p>
      <div class="form-actions">
        <button
          type="button"
          class="btn-primary"
          (click)="goToLogin()"
        >
          <i class="fas fa-arrow-left"></i>
          Voltar ao Login
        </button>
      </div>
    </div>

    <!-- Valid token - password reset form -->
    <div *ngIf="!isCheckingToken && isValidToken" class="reset-form-container">
      <div class="reset-header">
        <div class="success-icon">
          <i class="fas fa-key"></i>
        </div>
        <h2>Redefinir Senha</h2>
        <p>Digite sua nova senha abaixo.</p>
      </div>

      <!-- Success message -->
      <div *ngIf="successMessage" class="success-message">
        <i class="fas fa-check-circle"></i>
        {{ successMessage }}
      </div>

      <!-- Password reset form -->
      <form *ngIf="!successMessage" (ngSubmit)="onSubmit()" class="reset-form">
        <div class="form-group">
          <label for="newPassword">Nova Senha</label>
          <input
            type="password"
            id="newPassword"
            name="newPassword"
            [(ngModel)]="passwordData.newPassword"
            (input)="clearError()"
            placeholder="Digite sua nova senha"
            required
            class="form-control"
            [class.error]="error && passwordTooWeak"
            minlength="6"
          >
          <div class="password-requirements">
            <small>A senha deve ter pelo menos 6 caracteres</small>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirmar Nova Senha</label>
          <input
            type="password"
            id="confirmPassword"
            name="confirmPassword"
            [(ngModel)]="passwordData.confirmPassword"
            (input)="clearError()"
            placeholder="Digite novamente sua nova senha"
            required
            class="form-control"
            [class.error]="error && passwordMismatch"
            minlength="6"
          >
        </div>

        <!-- Error Message -->
        <div *ngIf="error" class="error-message">
          <i class="fas fa-exclamation-triangle"></i>
          {{ error }}
        </div>

        <!-- Submit Button -->
        <div class="form-actions">
          <button
            type="submit"
            class="btn-primary btn-reset"
            [disabled]="isLoading"
          >
            <span *ngIf="!isLoading">
              <i class="fas fa-save"></i>
              Alterar Senha
            </span>
            <span *ngIf="isLoading">
              <i class="fas fa-spinner fa-spin"></i>
              Alterando...
            </span>
          </button>

          <button
            type="button"
            class="btn-secondary"
            (click)="goToLogin()"
            [disabled]="isLoading"
          >
            <i class="fas fa-arrow-left"></i>
            Voltar ao Login
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Footer info -->
  <div class="footer-info">
    <p>
      <i class="fas fa-shield-alt"></i>
      Sua senha será criptografada e armazenada com segurança.
    </p>
  </div>
</div>
